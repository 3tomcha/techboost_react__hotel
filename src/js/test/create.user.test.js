jest.mock('node-fetch');

import fetch from 'node-fetch';
const {Response} = jest.requireActual('node-fetch');
import fetchGeoCode from '../src/js/libs/GoogleGeocodeAPI.js';

test('createUser calls fetch with the right args and returns userId', async() => {
  fetch.mockReturnValue(Promise.resolve(new Response({"ResultInfo":{"Count":10,"Total":60,"Start":1,"Status":200,"Description":"","Copyright":"","Latency":0.042},"Feature":[{"Id":"13101.55.1","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee","Geometry":{"Type":"point","Coordinates":"139.76560814,35.67851540","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"56efbf35fe6d62e808c2932f01be4391999cc5d1","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee","GovernmentCode":"13101","AddressMatchingLevel":"4","AddressType":"\u4e01\u76ee\u30fb\u5b57"}},{"Id":"13101.55.1.10","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee10","Geometry":{"Type":"point","Coordinates":"139.76541650,35.67803212","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"66e18f0d00bd1e08fec5ef8f0e0081c7d95f48a4","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee10","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}},{"Id":"13101.55.1.9","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee9","Geometry":{"Type":"point","Coordinates":"139.76717742,35.68039858","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"08b09f32e4878458f64a58c670961c497be4d507","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee9","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}},{"Id":"13101.55.1.2","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee2","Geometry":{"Type":"point","Coordinates":"139.76292215,35.68223160","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"278c8e50ac5ceb13a866a629cad45130f3f15a9b","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee2","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}},{"Id":"13101.55.1.8","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee8","Geometry":{"Type":"point","Coordinates":"139.76940222,35.68204013","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"6d8da550c246ec3ccb307bbf33e18d03380229c8","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee8","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}},{"Id":"13101.55.1.7","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee7","Geometry":{"Type":"point","Coordinates":"139.76824117,35.68375380","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"a640ec3596de321dd0d4b050791f1ad412555486","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee7","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}},{"Id":"13101.55.1.1","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee1","Geometry":{"Type":"point","Coordinates":"139.76194437,35.68490628","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"d847a4cb7bbdcfac4f0374cd5fda7f9c4402bfef","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee1","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}},{"Id":"13101.55.1.3","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee3","Geometry":{"Type":"point","Coordinates":"139.76372204,35.68409253","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"e15c466298bcead1c84f980c6661f242c60939c5","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee3","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}},{"Id":"13101.55.1.4","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee4","Geometry":{"Type":"point","Coordinates":"139.76441366,35.68396201","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"7f6e1c7283abba3dd9322bbc34230b2bbe436dae","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee4","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}},{"Id":"13101.55.1.11","Gid":"","Name":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee11","Geometry":{"Type":"point","Coordinates":"139.76646086,35.67799326","BoundingBox":"139.76023800,35.67729100 139.77065200,35.68575800"},"Category":[],"Description":"","Style":[],"Property":{"Uid":"27cdf968a8da1e67a0bf6c0085bd81029dc20fb1","CassetteId":"b22fee69b0dcaf2c2fe2d6a27906dafc","Yomi":"\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8\u30c1\u30e8\u30c0\u30af\u30de\u30eb\u30ce\u30a6\u30c11\u30c1\u30e7\u30a6\u30e1","Country":{"Code":"JP","Name":"\u65e5\u672c"},"Address":"\u6771\u4eac\u90fd\u5343\u4ee3\u7530\u533a\u4e38\u306e\u51851\u4e01\u76ee11","GovernmentCode":"13101","AddressMatchingLevel":"5","AddressType":"\u8857\u533a"}}]})));
  const geocode = await fetchGeoCode('東京都千代田区丸の内１丁目');
  expect(geocode).toBe('4');
});
